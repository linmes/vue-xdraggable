{"version":3,"file":"vue-draggable.min.js","sources":["../src/util/Observer.js","../src/util/Observable.js","../src/draggable.vue","../src/install.js","../src/index.js"],"sourcesContent":["var Observer = function(consumer){\n    this._consumer = consumer;\n};\nObserver.prototype.onNotify = function(data){\n    this._consumer.call(this,data);\n};\nexport default Observer;","var Observable = function(generator){\n    this._generator = generator;\n};\nObservable.prototype.subscribe = function(observer){\n    this._generator.call(this,observer);\n};\nexport default Observable;","<template>\n    <div>\n        <slot ref=\"drag\"></slot>\n    </div>\n</template>\n<script>\nimport Observer from './util/Observer.js';\nimport Observable from './util/Observable.js';\n//利用观察者模式和闭包的特性使事件只绑定一次，从而优化性能\nvar mouseup = new Observable((function(){\n    var observers = [] ;\n    document.addEventListener('mouseup',(e)=>{\n        observers.forEach((observer)=>{\n            observer.onNotify(e);\n        });\n    });\n    return function(observer){\n        observers.push(observer);\n    };\n})());\nvar mousemove = new Observable((function(){\n    var observers = [] ;\n    document.addEventListener('mousemove',(e)=>{\n        observers.forEach((observer)=>{\n            observer.onNotify(e);\n        });\n    });\n    return function(observer){\n        observers.push(observer);\n    };\n})());\nexport default {\n    props: {\n        move: {\n            type: String,\n            default: 'both'\n        },\n        randomPosition: {\n            type: Boolean,\n            default: false\n        }\n    },\n    data() {\n        return {\n            left: null,\n            top:  null,\n            //元素到鼠标的距离\n            pos:{\n                x:null,\n                y:null\n            },\n            //桌子的宽高\n            desk:{\n                width:null,\n                height:null\n            },\n            //移动物体的宽高\n            animal:{\n                width:null,\n                height:null\n            },\n            status: {\n                dragging :false\n            }\n        };\n    },\n    watch: {\n        left(val) {\n            this.$el.style.left = val+'px';\n        },\n        top(val) {\n            this.$el.style.top = val+'px';\n        }\n    },\n    mounted() {\n        //初始化桌子的宽高\n        this.desk.width = this.$el.parentNode.clientWidth;\n        this.desk.height = this.$el.parentNode.clientHeight;\n        //初始化移动物的宽高\n        this.animal.width = this.$el.clientWidth;\n        this.animal.height = this.$el.clientHeight;\n        var handle = this.$el.querySelector('[handle]')?this.$el.querySelector('[handle]'):this.$el;\n        //初始化随机位置\n        if(this.randomPosition){\n            this.$el.style.left = Math.floor(Math.random()*(this.desk.width - this.animal.width))+'px';\n            this.$el.style.top = Math.floor(Math.random()*(this.desk.height - this.animal.height))+'px';\n        }\n        this.left = this.$el.offsetLeft;\n        this.top = this.$el.offsetTop;\n        handle.addEventListener('mousedown',(e)=>{\n            this.$emit('dragstart',e);\n            this.status.dragging = true;\n            this.pos.x = e.clientX - this.left;\n            this.pos.y = e.clientY - this.top;\n        });\n        mousemove.subscribe(new Observer((e)=>{\n            e.preventDefault();\n            if(this.status.dragging==true){\n                this.$emit('dragging',e);\n                if(this.move == 'x' || this.move == 'both'){\n                    var left = (e.clientX-this.pos.x)>0?(e.clientX-this.pos.x):0;\n                    if(left>(this.desk.width-this.animal.width)){\n                        left = this.desk.width-this.animal.width;\n                    }\n                    this.left = left;\n                }\n                if(this.move == 'y' || this.move == 'both'){\n                    var top = (e.clientY-this.pos.y)>0?(e.clientY-this.pos.y):0;\n                    if(top>(this.desk.height-this.animal.height)){\n                        top = this.desk.height-this.animal.height;\n                    }\n                    this.top = top;\n                }\n            }\n        }));\n        mouseup.subscribe(new Observer((e)=>{\n            if(this.status.dragging==true){\n                this.$emit('dragend',e);\n            }\n            this.status.dragging = false;\n        }));\n    }\n};\n</script>\n<style>\n\n</style>\n\n","import Draggable from './draggable.vue';\nvar state = false;\n\nexport default function (Vue) {\n    if (state) return;\n    state = true;\n    Vue.component('draggable', Draggable);\n}","import install from './install';\r\n\r\nif (typeof window !== 'undefined' && window.Vue) {\r\n    install(window.Vue);\r\n}\r\n\r\nexport default install;"],"names":["Observer","consumer","_consumer","prototype","onNotify","data","call","this","Observable","generator","_generator","subscribe","observer","mouseup","observers","addEventListener","e","forEach","push","mousemove","String","Boolean","val","$el","style","left","top","desk","width","parentNode","clientWidth","height","clientHeight","animal","handle","querySelector","randomPosition","Math","floor","random","offsetLeft","offsetTop","$emit","status","dragging","pos","x","clientX","_this","y","clientY","preventDefault","move","state","Vue","component","Draggable","window"],"mappings":"wLAAA,IAAIA,EAAW,SAASC,QACfC,UAAYD,GAErBD,EAASG,UAAUC,SAAW,SAASC,QAC9BH,UAAUI,KAAKC,KAAKF,ICJ7B,IAAIG,EAAa,SAASC,QACjBC,WAAaD,GAEtBD,EAAWL,UAAUQ,UAAY,SAASC,QACjCF,WAAWJ,KAAKC,KAAKK,ICK9B,IAAIC,EAAU,IAAIL,EAAY,eACtBM,qBACKC,iBAAiB,UAAU,SAACC,KACvBC,QAAQ,SAACL,KACNR,SAASY,OAGnB,SAASJ,KACFM,KAAKN,QAGnBO,EAAY,IAAIX,EAAY,eACxBM,qBACKC,iBAAiB,YAAY,SAACC,KACzBC,QAAQ,SAACL,KACNR,SAASY,OAGnB,SAASJ,KACFM,KAAKN,kJAMLQ,eACG,6BAGHC,iBACG,gCAKH,SACA,YAGA,OACA,kBAII,YACC,oBAID,YACC,wBAGG,0BAKbC,QACIC,IAAIC,MAAMC,KAAOH,EAAI,mBAE1BA,QACKC,IAAIC,MAAME,IAAMJ,EAAI,0CAKxBK,KAAKC,MAAQrB,KAAKgB,IAAIM,WAAWC,iBACjCH,KAAKI,OAASxB,KAAKgB,IAAIM,WAAWG,kBAElCC,OAAOL,MAAQrB,KAAKgB,IAAIO,iBACxBG,OAAOF,OAASxB,KAAKgB,IAAIS,iBAC1BE,EAAS3B,KAAKgB,IAAIY,cAAc,YAAY5B,KAAKgB,IAAIY,cAAc,YAAY5B,KAAKgB,IAErFhB,KAAK6B,sBACCb,IAAIC,MAAMC,KAAOY,KAAKC,MAAMD,KAAKE,UAAUhC,KAAKoB,KAAKC,MAAQrB,KAAK0B,OAAOL,QAAQ,UACjFL,IAAIC,MAAME,IAAMW,KAAKC,MAAMD,KAAKE,UAAUhC,KAAKoB,KAAKI,OAASxB,KAAK0B,OAAOF,SAAS,WAEtFN,KAAOlB,KAAKgB,IAAIiB,gBAChBd,IAAMnB,KAAKgB,IAAIkB,YACb1B,iBAAiB,YAAY,SAACC,KAC5B0B,MAAM,YAAY1B,KAClB2B,OAAOC,UAAW,IAClBC,IAAIC,EAAI9B,EAAE+B,QAAUC,EAAKvB,OACzBoB,IAAII,EAAIjC,EAAEkC,QAAUF,EAAKtB,QAExBf,UAAU,IAAIX,EAAS,SAACgB,QAC5BmC,iBACuB,GAAtBH,EAAKL,OAAOC,SAAe,MACrBF,MAAM,WAAW1B,GACN,KAAbgC,EAAKI,MAA4B,QAAbJ,EAAKI,KAAe,KACnC3B,EAAQT,EAAE+B,QAAQC,EAAKH,IAAIC,EAAG,EAAG9B,EAAE+B,QAAQC,EAAKH,IAAIC,EAAG,EACxDrB,EAAMuB,EAAKrB,KAAKC,MAAMoB,EAAKf,OAAOL,UAC1BoB,EAAKrB,KAAKC,MAAMoB,EAAKf,OAAOL,SAElCH,KAAOA,KAEA,KAAbuB,EAAKI,MAA4B,QAAbJ,EAAKI,KAAe,KACnC1B,EAAOV,EAAEkC,QAAQF,EAAKH,IAAII,EAAG,EAAGjC,EAAEkC,QAAQF,EAAKH,IAAII,EAAG,EACvDvB,EAAKsB,EAAKrB,KAAKI,OAAOiB,EAAKf,OAAOF,WAC3BiB,EAAKrB,KAAKI,OAAOiB,EAAKf,OAAOF,UAElCL,IAAMA,SAIff,UAAU,IAAIX,EAAS,SAACgB,GACH,GAAtBgC,EAAKL,OAAOC,YACNF,MAAM,UAAU1B,KAEpB2B,OAAOC,UAAW,OCtH/BS,GAAQ,IAEG,SAAUC,GACjBD,OACI,IACJE,UAAU,YAAaC,WCJT,oBAAXC,QAA0BA,OAAOH,OAChCG,OAAOH"}